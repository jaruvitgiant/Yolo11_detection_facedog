from ultralytics import YOLO

model = YOLO("yolo11n.pt")

model.train(
    data="DogDatasets/data.yml",  
    epochs=100,                   
    imgsz=224,                    
    batch=16,                     
    device="cpu",                 
    workers=0,
    dropout=0.2,         
           
    # üîπ Hyperparameters ‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏£‡∏π‡πâ
    lr0=0.01,                      # ‡∏Ñ‡πà‡∏≤ learning rate ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô
    lrf=0.01,                      # ‡∏Ñ‡πà‡∏≤ learning rate ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î‡∏Å‡∏≤‡∏£ train (final lr)
    momentum=0.9,                  # momentum ‡∏Ç‡∏≠‡∏á optimizer (‡∏ä‡πà‡∏ß‡∏¢‡∏õ‡∏£‡∏±‡∏ö‡∏ó‡∏¥‡∏®‡∏ó‡∏≤‡∏á weight)
    weight_decay=0.0005,           # ‡∏Ñ‡πà‡∏≤‡∏•‡∏î‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô overfitting (L2 regularization)
    warmup_epochs=3,               # ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô epoch ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö warmup (‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏ä‡πâ‡∏≤‡πÜ‡∏Å‡πà‡∏≠‡∏ô)

    warmup_momentum=0.8,           # momentum ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á warmup
    warmup_bias_lr=0.1,            # learning rate ‡∏Ç‡∏≠‡∏á bias ‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á warmup
    
    # üîπ Data augmentation (‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏•‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏Ç‡∏≠‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•)
    fliplr=0.5,                    # ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏û‡∏•‡∏¥‡∏Å‡∏£‡∏π‡∏õ‡πÅ‡∏ô‡∏ß‡∏ô‡∏≠‡∏ô (0.5 = 50%)
    degrees=10.0,                  # ‡∏´‡∏°‡∏∏‡∏ô‡∏†‡∏≤‡∏û‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏° ¬±10 ‡∏≠‡∏á‡∏®‡∏≤
    translate=0.1,                 # ‡∏Å‡∏≤‡∏£‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏†‡∏≤‡∏û‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏° (10%)
    scale=0.2,                     # ‡∏Å‡∏≤‡∏£‡∏¢‡πà‡∏≠/‡∏Ç‡∏¢‡∏≤‡∏¢‡∏†‡∏≤‡∏û‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏° (¬±20%)
    shear=2.0,                     # ‡∏Å‡∏≤‡∏£‡∏ö‡∏¥‡∏î‡∏†‡∏≤‡∏û (shear) ‡πÅ‡∏ö‡∏ö‡∏™‡∏∏‡πà‡∏°
    hsv_h=0.015,                   # ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ Hue ‡∏Ç‡∏≠‡∏á‡∏™‡∏µ (¬±0.015)
    hsv_s=0.7,                     # ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ Saturation ‡∏Ç‡∏≠‡∏á‡∏™‡∏µ (¬±70%)
    hsv_v=0.4,                     # ‡∏õ‡∏£‡∏±‡∏ö‡∏Ñ‡πà‡∏≤ Value (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏ß‡πà‡∏≤‡∏á) (¬±40%)
    mosaic=0.7,                    # ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ mosaic augmentation (‡∏£‡∏ß‡∏°‡∏´‡∏•‡∏≤‡∏¢‡∏†‡∏≤‡∏û) (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡πà‡∏≤‡∏à‡∏∞‡πÄ‡∏õ‡πá‡∏ô 70%)
    mixup=0.1,                     # ‡∏Å‡∏≤‡∏£‡∏ó‡∏≥ mixup (‡∏ú‡∏™‡∏°‡∏†‡∏≤‡∏û‡∏ã‡πâ‡∏≠‡∏ô‡∏Å‡∏±‡∏ô) (10%)

    # üîπ Loss function settings
    box=7.5,                       # ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å loss ‡∏Ç‡∏≠‡∏á bounding box
    cls=0.5,                       # ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å loss ‡∏Ç‡∏≠‡∏á class prediction
    dfl=1.5,                       # ‡∏Ñ‡πà‡∏≤‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å loss ‡∏Ç‡∏≠‡∏á Distribution Focal Loss
    # fl_gamma=0.0,                # focal loss gamma (‡∏Ñ‡πà‡∏≤ default = 0 ‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô)
    label_smoothing=0.05,          # ‡∏Ñ‡πà‡∏≤ label smoothing (‡∏ó‡∏≥‡πÉ‡∏´‡πâ target ‡πÑ‡∏°‡πà‡πÄ‡∏õ‡πá‡∏ô one-hot ‡πÅ‡∏Ç‡πá‡∏á‡πÄ‡∏Å‡∏¥‡∏ô‡πÑ‡∏õ)
)

